<!-- templates/admin/dashboard.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<style>
.ai-modal{position:fixed; inset:0; z-index:1000;}
.ai-modal__backdrop{position:absolute; inset:0; background:rgba(0,0,0,.4);}
.ai-modal__dialog{
  position:absolute; right:24px; top:24px; width:min(760px, 80vw); height:min(80vh, 680px);
  background:#fff; border-radius:10px; box-shadow:0 10px 30px rgba(0,0,0,.2); display:flex; flex-direction:column;
}
.ai-modal__header{display:flex; justify-content:space-between; align-items:center; padding:12px 14px; border-bottom:1px solid #eee;}
.ai-modal__actions button{margin-left:6px;}
.ai-modal__body{padding:14px; overflow:auto; white-space:pre-wrap; line-height:1.6;}
</style>
<th:block th:fragment="content">
  <h2>외환 상품 대시보드</h2>
  <div class="report-toolbar">
  <button id="btn-generate-report">리포트 생성</button>
  <button id="btn-open-pdf"  disabled>PDF 보기</button>
  <button id="btn-open-excel" disabled>Excel</button>
  </div>
  <pre id="ai-report" style="white-space:pre-wrap; margin-top:8px;"></pre>
  <!-- ① 가입자수 (일·월·분기) ------------------------------------------- -->
  <section class="chart-section">
  <h3>가입자수 추이</h3>

  <div class="chart-grid">
    <div>
      <h4>일별</h4>
      <div id="chart-daily" class="chart-box"></div>
    </div>
    <div>
      <h4>월별</h4>
      <div id="chart-monthly" class="chart-box"></div>
    </div>
    <div>
      <h4>분기별</h4>
      <div id="chart-quarterly" class="chart-box"></div>
    </div>
  </div>
</section>
  <!-- ② 가입자 연령/성별 분포 ------------------------------------------- -->
  <section class="card grid-2">
    <div>
      <h3>연령대별 분포</h3>
      <div id="age-bar" class="chart-md"></div>
    </div>
    <div>
      <h3>성별 비율</h3>
      <div id="gender-pie" class="chart-md"></div>
    </div>
  </section>

  <!-- ③ 리뷰 지표 -------------------------------------------------------- -->
  <section class="card grid-3">
    <div>
      <h3>월별 리뷰 수</h3>
      <div id="review-count-bar" class="chart-sm"></div>
    </div>
    <div>
      <h3>평점 평균 (최근 6 개월)</h3>
      <div id="rating-line" class="chart-sm"></div>
    </div>
    <div>
      <h3>긍·부정 키워드</h3>
      <div id="sentiment-wordcloud" class="chart-sm"></div>
    </div>
  </section>

  <!-- ④ 누적 원화 사용액 & 추천 클릭 -------------------------------------- -->
  <section class="card grid-2">
    <div>
      <h3>누적 사용액(₩)</h3>
      <div id="krw-area" class="chart-md"></div>
    </div>
    <div>
      <h3>추천(공유) 클릭 수</h3>
      <div id="share-gauge" class="chart-md"></div>
    </div>
  </section>

  <!-- ⑤ 최근 리뷰 리스트 -------------------------------------------------- -->
  <section class="card">
    <h3>최근 리뷰</h3>
    <table class="review-table">
      <thead><tr><th>일자</th><th>닉네임</th><th>평점</th><th>내용</th></tr></thead>
      <tbody id="review-list">
        <!-- 더미 → JS에서 주입, 추후 서버수신 데이터 적용 -->
      </tbody>
    </table>
  </section>
  
  <!-- AI 리포트 모달 -->
<div id="ai-report-modal" class="ai-modal" style="display:none;">
  <div class="ai-modal__backdrop"></div>
  <div class="ai-modal__dialog" role="dialog" aria-modal="true" aria-labelledby="aiReportTitle">
    <div class="ai-modal__header">
      <h3 id="aiReportTitle">AI 리포트</h3>
      <div class="ai-modal__actions">
        <button id="ai-modal-print">인쇄(PDF)</button>
        <button id="ai-modal-popout">새 창</button>
        <button id="ai-modal-close" aria-label="닫기">×</button>
      </div>
    </div>
    <div id="ai-report-body" class="ai-modal__body"><!-- 내용 주입 --></div>
  </div>
</div>
  <!-- ECharts & 초기화 스크립트 ------------------------------------------ -->
  <script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
  <script th:src="@{/js/echarts-dashboard.js}"></script>
</th:block>
</html>
